"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5546],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>f});var r=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,o=function(e,t){if(null==e)return{};var a,r,o={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=r.createContext({}),c=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var a=e.components,o=e.mdxType,n=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(a),f=o,m=d["".concat(s,".").concat(f)]||d[f]||p[f]||n;return a?r.createElement(m,i(i({ref:t},u),{},{components:a})):r.createElement(m,i({ref:t},u))}));function f(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var n=a.length,i=new Array(n);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<n;c++)i[c]=a[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"},5944:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>n,metadata:()=>l,toc:()=>c});var r=a(7462),o=(a(7294),a(3905));const n={sidebar_position:6,sidebar_label:"Fast Failover"},i="Application Fast Failover",l={unversionedId:"quick_start/advanced_features/fast_failover",id:"quick_start/advanced_features/fast_failover",title:"Application Fast Failover",description:"When the stateful application (i.e. Pod with HwameiStor volume) runs into a problem, especially caused by the node issue,",source:"@site/docs/quick_start/advanced_features/fast_failover.md",sourceDirName:"quick_start/advanced_features",slug:"/quick_start/advanced_features/fast_failover",permalink:"/docs/quick_start/advanced_features/fast_failover",draft:!1,editUrl:"https://github.com/hwameistor/hwameistor/edit/main/docs/docs/quick_start/advanced_features/fast_failover.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,sidebar_label:"Fast Failover"},sidebar:"tutorialSidebar",previous:{title:"Volume Snapshot",permalink:"/docs/quick_start/advanced_features/volume_snapshot"},next:{title:"Volume Clone",permalink:"/docs/quick_start/advanced_features/volume_clone"}},s={},c=[{value:"How to use",id:"how-to-use",level:2}],u={toc:c};function p(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"application-fast-failover"},"Application Fast Failover"),(0,o.kt)("p",null,"When the stateful application (i.e. Pod with HwameiStor volume) runs into a problem, especially caused by the node issue,\nit's important to reschedule the Pod to another healthy node and keep running."),(0,o.kt)("p",null,"However, due to the design of the Kubernetes' StatefulSet and Deployment,\nit will wait a long time (e.g. 5 mins) before rescheduling the Pod.\nEspecially, it will never reschedule the Pod automatically for the StatefulSet Pod.\nThis will cause the application stop, and even cause a huge business loss."),(0,o.kt)("p",null,"HwameiStor provides a feature of fast failover to solve this problem. When identifying the application issue,\nit will reschedule the Pod immediately without waiting for a very long time.\nHwameiStor will fail the Pod over to another healthy node, and ensure the required data volumes are also located at the node.\nSo, the application can continue to work."),(0,o.kt)("h2",{id:"how-to-use"},"How to use"),(0,o.kt)("p",null,"HwameiStor provides the fast failover considering the two cases:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Node Failure  "),(0,o.kt)("p",{parentName:"li"},"When a node fails, all the Pods on this node can't work any more\u3002As to the Pod using HwameiStor volume\uff0c\nit's necessary to reschedule to another healthy node with the associated data volume replica.\nYou can trigger the fast failover for this node by:"),(0,o.kt)("p",{parentName:"li"},"Add a label to this node:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl label node <nodeName> hwameistor.io/failover=start\n")),(0,o.kt)("p",{parentName:"li"},"When the fast failover completes, the label will be modified as:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-console"},"hwameistor.io/failover=completed\n"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Pod Failure"),(0,o.kt)("p",{parentName:"li"},"When a Pod fails, you can trigger the fast failover for it by adding a lable to this Pod:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl label pod <podName> hwameistor.io/failover=start\n")),(0,o.kt)("p",{parentName:"li"},"When the fast failover completes, the old Pod will be deleted and then the new one will be created on a new node."))))}p.isMDXComponent=!0}}]);