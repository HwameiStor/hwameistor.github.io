"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6018],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>u});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},k=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,s=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),k=d(n),u=o,m=k["".concat(l,".").concat(u)]||k[u]||c[u]||s;return n?a.createElement(m,r(r({ref:t},p),{},{components:n})):a.createElement(m,r({ref:t},p))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=n.length,r=new Array(s);r[0]=k;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,r[1]=i;for(var d=2;d<s;d++)r[d]=n[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},107:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var a=n(7462),o=(n(7294),n(3905));const s={sidebar_position:4,sidebar_label:"Disk Expansion"},r="Disk Expansion",i={unversionedId:"nodes_and_disks/disk_expansion",id:"nodes_and_disks/disk_expansion",title:"Disk Expansion",description:"A storage system is usually expected to expand its capacity by adding a new disk",source:"@site/docs/nodes_and_disks/disk_expansion.md",sourceDirName:"nodes_and_disks",slug:"/nodes_and_disks/disk_expansion",permalink:"/docs/nodes_and_disks/disk_expansion",draft:!1,editUrl:"https://github.com/hwameistor/hwameistor/edit/main/docs/docs/nodes_and_disks/disk_expansion.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,sidebar_label:"Disk Expansion"},sidebar:"tutorialSidebar",previous:{title:"Disk Storage Node",permalink:"/docs/nodes_and_disks/disk_nodes"},next:{title:"StorageClass",permalink:"/docs/category/storageclass"}},l={},d=[{value:"Prepare a new storage disk",id:"prepare-a-new-storage-disk",level:2},{value:"Add the new disk into the node&#39;s storage pool",id:"add-the-new-disk-into-the-nodes-storage-pool",level:2},{value:"Post check",id:"post-check",level:2}],p={toc:d};function c(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"disk-expansion"},"Disk Expansion"),(0,o.kt)("p",null,"A storage system is usually expected to expand its capacity by adding a new disk\ninto a storage node. In HwameiStor, it can be done with the following steps."),(0,o.kt)("h2",{id:"prepare-a-new-storage-disk"},"Prepare a new storage disk"),(0,o.kt)("p",null,"Select a storage node from the HwameiStor system, and add a new disk into it."),(0,o.kt)("p",null,"For example, the storage node and new disk information are as follows:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"name: k8s-worker-4"),(0,o.kt)("li",{parentName:"ul"},"devPath: /dev/sdc"),(0,o.kt)("li",{parentName:"ul"},"diskType: SSD")),(0,o.kt)("p",null,"After the new disk is added into the storage node ",(0,o.kt)("inlineCode",{parentName:"p"},"k8s-worker-4"),", you can check the disk status as below."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Check if the new disk is added into the node successfully"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ssh root@k8s-worker-4\nlsblk | grep sdc\n")),(0,o.kt)("p",{parentName:"li"},"The output may look like:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-none"},"sdc        8:32     0     20G  1 disk\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'Check if the LocalDisk CR already exists for the new disk and the status is "Unclaimed"'),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get localdisk | grep k8s-worker-4 | grep sdc\n")),(0,o.kt)("p",{parentName:"li"},"The output may look like:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-none"},"k8s-worker-4-sdc   k8s-worker-4       Available \n")))),(0,o.kt)("h2",{id:"add-the-new-disk-into-the-nodes-storage-pool"},"Add the new disk into the node's storage pool"),(0,o.kt)("p",null,"The new disk should be added into the existing SSD storage pool of the node.\nIf the storage pool doesn't exist, it will be constructed automatically and the new disk should be added into it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-console"},"$ kubectl apply -f - <<EOF\napiVersion: hwameistor.io/v1alpha1\nkind: LocalDiskClaim\nmetadata:\n  name: k8s-worker-4-expand\nspec:\n  nodeName: k8s-worker-4\n  owner: local-storage\n  description:\n    diskType: SSD\nEOF\n")),(0,o.kt)("h2",{id:"post-check"},"Post check"),(0,o.kt)("p",null,"Finally, check if the new disk has been added into the node's storage pool successfully by checking the LocalStorageNode CR:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get localstoragenode k8s-worker-4\n")),(0,o.kt)("p",null,"The output may look like:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: hwameistor.io/v1alpha1\nkind: LocalStorageNode\nmetadata:\n  name: k8s-worker-4\nspec:\n  hostname: k8s-worker-4\n  storageIP: 10.6.182.103\n  topogoly:\n    region: default\n    zone: default\nstatus:\n  pools:\n    LocalStorage_PoolSSD:\n      class: SSD\n      disks:\n      - capacityBytes: 214744170496\n        devPath: /dev/sdb\n        state: InUse\n        type: SSD\n      - capacityBytes: 214744170496\n        devPath: /dev/sdc\n        state: InUse\n        type: SSD\n      freeCapacityBytes: 429488340992\n      freeVolumeCount: 1000\n      name: LocalStorage_PoolSSD\n      totalCapacityBytes: 429488340992\n      totalVolumeCount: 1000\n      type: REGULAR\n      usedCapacityBytes: 0\n      usedVolumeCount: 0\n      volumeCapacityBytesLimit: 429488340992\n      volumes:\n  state: Ready\n")))}c.isMDXComponent=!0}}]);