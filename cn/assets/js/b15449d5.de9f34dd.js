"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1966],{3905:(e,r,t)=>{t.d(r,{Zo:()=>k,kt:()=>u});var n=t(7294);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function s(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=n.createContext({}),c=function(e){var r=n.useContext(i),t=r;return e&&(t="function"==typeof e?e(r):l(l({},r),e)),t},k=function(e){var r=c(e.components);return n.createElement(i.Provider,{value:r},e.children)},p={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},d=n.forwardRef((function(e,r){var t=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,k=s(e,["components","mdxType","originalType","parentName"]),d=c(t),u=a,m=d["".concat(i,".").concat(u)]||d[u]||p[u]||o;return t?n.createElement(m,l(l({ref:r},k),{},{components:t})):n.createElement(m,l({ref:r},k))}));function u(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=d;var s={};for(var i in r)hasOwnProperty.call(r,i)&&(s[i]=r[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,l[1]=s;for(var c=2;c<o;c++)l[c]=t[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}d.displayName="MDXCreateElement"},5137:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>i,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=t(7462),a=(t(7294),t(3905));const o={sidebar_position:4,sidebar_label:"\u521b\u5efa\u5b58\u50a8\u6c60"},l="\u521b\u5efa\u5b58\u50a8\u6c60",s={unversionedId:"quick_start/install/storage_pool",id:"quick_start/install/storage_pool",title:"\u521b\u5efa\u5b58\u50a8\u6c60",description:"\u4e0b\u9762\u7684\u4f8b\u5b50\u6765\u81ea\u4e8e\u4e00\u4e2a 4 \u8282\u70b9\u7684 Kubernetes \u96c6\u7fa4\uff1a",source:"@site/i18n/cn/docusaurus-plugin-content-docs/current/quick_start/install/storage_pool.md",sourceDirName:"quick_start/install",slug:"/quick_start/install/storage_pool",permalink:"/cn/docs/quick_start/install/storage_pool",draft:!1,editUrl:"https://github.com/hwameistor/hwameistor/docs/quick_start/install/storage_pool.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,sidebar_label:"\u521b\u5efa\u5b58\u50a8\u6c60"},sidebar:"tutorialSidebar",previous:{title:"\u5b89\u88c5\u540e\u68c0\u67e5",permalink:"/cn/docs/quick_start/install/post_check"},next:{title:"Start a Stateful Application",permalink:"/cn/docs/category/start-a-stateful-application"}},i={},c=[{value:"\u6b65\u9aa4",id:"\u6b65\u9aa4",level:2},{value:"1. \u521b\u5efa <code>LocalDiskClaim</code> \u5bf9\u8c61",id:"1-\u521b\u5efa-localdiskclaim-\u5bf9\u8c61",level:3},{value:"2. \u9a8c\u8bc1 <code>LocalDiskClaim</code> \u5bf9\u8c61",id:"2-\u9a8c\u8bc1-localdiskclaim-\u5bf9\u8c61",level:3},{value:"3. \u9a8c\u8bc1 <code>StorageClass</code>",id:"3-\u9a8c\u8bc1-storageclass",level:3},{value:"4. \u9a8c\u8bc1 <code>LocalDisk</code> \u5bf9\u8c61",id:"4-\u9a8c\u8bc1-localdisk-\u5bf9\u8c61",level:3},{value:"5. \u89c2\u5bdf <code>VG</code> (\u53ef\u9009)",id:"5-\u89c2\u5bdf-vg-\u53ef\u9009",level:3},{value:"\u5b89\u88c5\u671f\u95f4\u914d\u7f6e\u5b58\u50a8\u6c60",id:"\u5b89\u88c5\u671f\u95f4\u914d\u7f6e\u5b58\u50a8\u6c60",level:2}],k={toc:c};function p(e){let{components:r,...t}=e;return(0,a.kt)("wrapper",(0,n.Z)({},k,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u521b\u5efa\u5b58\u50a8\u6c60"},"\u521b\u5efa\u5b58\u50a8\u6c60"),(0,a.kt)("p",null,"\u4e0b\u9762\u7684\u4f8b\u5b50\u6765\u81ea\u4e8e\u4e00\u4e2a 4 \u8282\u70b9\u7684 Kubernetes \u96c6\u7fa4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"$ kubectl get no\nNAME           STATUS   ROLES   AGE   VERSION\nk8s-master-1   Ready    master  82d   v1.24.3-2+63243a96d1c393\nk8s-worker-1   Ready    worker  36d   v1.24.3-2+63243a96d1c393\nk8s-worker-2   Ready    worker  59d   v1.24.3-2+63243a96d1c393\nk8s-worker-3   Ready    worker  36d   v1.24.3-2+63243a96d1c393\n")),(0,a.kt)("h2",{id:"\u6b65\u9aa4"},"\u6b65\u9aa4"),(0,a.kt)("h3",{id:"1-\u521b\u5efa-localdiskclaim-\u5bf9\u8c61"},"1. \u521b\u5efa ",(0,a.kt)("inlineCode",{parentName:"h3"},"LocalDiskClaim")," \u5bf9\u8c61"),(0,a.kt)("p",null,"HwameiStor \u6839\u636e\u5b58\u50a8\u4ecb\u8d28\u7c7b\u578b\u521b\u5efa ",(0,a.kt)("inlineCode",{parentName:"p"},"LocalDiskClaim")," \u5bf9\u8c61\u6765\u521b\u5efa\u5b58\u50a8\u6c60\u3002\n\u8981\u5728\u6240\u6709 Kubernetes Worker \u8282\u70b9\u4e0a\u521b\u5efa\u4e00\u4e2a HDD \u5b58\u50a8\u6c60\uff0c\u7528\u6237\u9700\u8981\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"storageNodes")," \u53c2\u6570\u8f93\u5165\u5404\u4e2a Worker \u8282\u70b9\u540d\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"$ helm template ./hwameistor \\\n   -s templates/post-install-claim-disks.yaml \\\n   --set storageNodes='{k8s-worker-1,k8s-worker-2,k8s-worker-3}' \\\n   | kubectl apply -f -\n")),(0,a.kt)("p",null,"\u6216\u8005\u901a\u8fc7\u4ee5\u4e0b\u65b9\u6cd5\u6307\u5b9a\u6240\u6709 Worker \u8282\u70b9\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},'$ sn="$( kubectl get no -l node-role.kubernetes.io/worker -o jsonpath="{.items[*].metadata.name}" | tr \' \' \',\' )"\n\n$ helm template ./hwameistor \\\n    -s templates/post-install-claim-disks.yaml \\\n    --set storageNodes="{$sn}" \\\n  | kubectl apply -f -\n')),(0,a.kt)("h3",{id:"2-\u9a8c\u8bc1-localdiskclaim-\u5bf9\u8c61"},"2. \u9a8c\u8bc1 ",(0,a.kt)("inlineCode",{parentName:"h3"},"LocalDiskClaim")," \u5bf9\u8c61"),(0,a.kt)("p",null,"\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"$ kubectl get ldc\nNAME           NODEMATCH      PHASE\nk8s-worker-1   k8s-worker-1   Bound\nk8s-worker-2   k8s-worker-2   Bound\nk8s-worker-3   k8s-worker-3   Bound\n")),(0,a.kt)("h3",{id:"3-\u9a8c\u8bc1-storageclass"},"3. \u9a8c\u8bc1 ",(0,a.kt)("inlineCode",{parentName:"h3"},"StorageClass")),(0,a.kt)("p",null,"\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"$ kubectl get sc hwameistor-storage-lvm-hdd\nNAME                         PROVISIONER         RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE\nhwameistor-storage-lvm-hdd   lvm.hwameistor.io   Delete          WaitForFirstConsumer   true                   114s\n")),(0,a.kt)("h3",{id:"4-\u9a8c\u8bc1-localdisk-\u5bf9\u8c61"},"4. \u9a8c\u8bc1 ",(0,a.kt)("inlineCode",{parentName:"h3"},"LocalDisk")," \u5bf9\u8c61"),(0,a.kt)("p",null,"\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"$ kubectl get ld\n")),(0,a.kt)("p",null,"\u8f93\u51fa\u7c7b\u4f3c\u4e8e\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"NAME               NODEMATCH      CLAIM          PHASE\nk8s-worker-1-sda   k8s-worker-1                  Inuse\nk8s-worker-1-sdb   k8s-worker-1   k8s-worker-1   Claimed\nk8s-worker-1-sdc   k8s-worker-1   k8s-worker-1   Claimed\nk8s-worker-2-sda   k8s-worker-2                  Inuse\nk8s-worker-2-sdb   k8s-worker-2   k8s-worker-2   Claimed\nk8s-worker-2-sdc   k8s-worker-2   k8s-worker-2   Claimed\nk8s-worker-3-sda   k8s-worker-3                  Inuse\nk8s-worker-3-sdb   k8s-worker-3   k8s-worker-3   Claimed\nk8s-worker-3-sdc   k8s-worker-3   k8s-worker-3   Claimed\n")),(0,a.kt)("h3",{id:"5-\u89c2\u5bdf-vg-\u53ef\u9009"},"5. \u89c2\u5bdf ",(0,a.kt)("inlineCode",{parentName:"h3"},"VG")," (\u53ef\u9009)"),(0,a.kt)("p",null,"\u5728\u4e00\u4e2a Kubernetes Worker \u8282\u70b9\u4e0a\uff0c\u89c2\u5bdf\u4e3a ",(0,a.kt)("inlineCode",{parentName:"p"},"LocalDiskClaim")," \u5bf9\u8c61\u521b\u5efa ",(0,a.kt)("inlineCode",{parentName:"p"},"VG"),"\u3002"),(0,a.kt)("p",null,"\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"$ vgdisplay LocalStorage_PoolHDD\n  --- Volume group ---\n  VG Name               LocalStorage_PoolHDD\n  System ID\n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  1\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                0\n  Open LV               0\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               199.99 GiB\n  PE Size               4.00 MiB\n  Total PE              51198\n  Alloc PE / Size       0 / 0\n  Free  PE / Size       51198 / 199.99 GiB\n  VG UUID               jJ3s7g-iyoJ-c4zr-3Avc-3K4K-BrJb-A5A5Oe\n")),(0,a.kt)("h2",{id:"\u5b89\u88c5\u671f\u95f4\u914d\u7f6e\u5b58\u50a8\u6c60"},"\u5b89\u88c5\u671f\u95f4\u914d\u7f6e\u5b58\u50a8\u6c60"),(0,a.kt)("p",null,"\u5728\u5b89\u88c5 HwameiStor \u671f\u95f4\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e ",(0,a.kt)("inlineCode",{parentName:"p"},"storageNode")," \u53c2\u6570\u914d\u7f6e\u5b58\u50a8\u6c60\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"$ helm install hwameistor ./hwameistor \\\n    -n hwameistor --create-namespace \\\n    --set storageNodes='{k8s-worker-1,k8s-worker-2,k8s-worker-3}'\n")))}p.isMDXComponent=!0}}]);